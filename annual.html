<!doctype html>
<html lang="ko" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>연차휴가 계산기 (입사일 기준 · 회계연도 기준)</title>
<meta name="description" content="입사일/퇴사일을 입력하면 연차휴가가 자동 계산됩니다. (입사일 기준, 회계연도 기준 동시 표시)" />
<style>
  :root{
    --bg:#f6f8fb; --surface:#fff; --line:#e5eaf0; --text:#0d1b2a; --muted:#516173;
    --title:#0a0f18; --accent:#2a66ff; --ring:rgba(42,102,255,.22);
    --sec-bg:#0a2a60; --sec-fg:#fff; --yellow:#fff9e6;
  }
  [data-theme="dark"]{
    --bg:#0a0e13; --surface:#0f1520; --line:#1f2a3a; --text:#eef4fb; --muted:#8ea4b8;
    --title:#fff; --accent:#62a8ff; --ring:rgba(98,168,255,.35);
    --sec-bg:#0a2a60; --sec-fg:#fff; --yellow:#2a2412;
  }

  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,Helvetica,Arial,sans-serif}
  table,th,td{white-space:nowrap;} /* ✅ 줄바꿈 방지 */

  /* 상단 바 */
  .appbar{position:sticky;top:0;z-index:10;display:flex;gap:12px;align-items:center;justify-content:space-between;
    padding:12px 16px;background:var(--bg);border-bottom:1px solid var(--line);backdrop-filter:saturate(140%) blur(6px)}
  .brand a{display:inline-flex;align-items:center;gap:10px;font-weight:900;color:var(--title);text-decoration:none;letter-spacing:.2px}
  .brand .logo{width:28px;height:28px;border-radius:8px;display:inline-block;
    background:linear-gradient(135deg,#0a2a60 0%,#2a66ff 60%,#19a06a 100%);
    box-shadow:0 2px 8px rgba(0,0,0,.15)}

  select,.btn{border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:var(--surface);color:var(--text);outline:none;transition:.15s}
  select:hover{border-color:color-mix(in oklab, var(--accent) 30%, var(--line))}
  .btn{border:1px solid var(--accent);background:color-mix(in oklab,var(--accent) 12%,var(--surface));font-weight:700;cursor:pointer}

  .container{max-width:1100px;margin:24px auto 80px;padding:0 16px}
  .sheet{background:var(--surface);border:1px solid var(--line);border-radius:18px;overflow:hidden;box-shadow:0 8px 30px rgba(0,0,0,.08)}
  .sheet h1{margin:0;padding:18px;text-align:center;font-size:20px;font-weight:800;color:var(--title);
    border-bottom:1px solid var(--line);background:color-mix(in oklab,var(--surface) 92%,var(--bg))}

  .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center;padding:12px 16px;border-bottom:1px solid var(--line);background:var(--surface)}
  .controls input[type="text"]{border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:var(--surface);color:var(--text);
    outline:none;transition:.15s;box-shadow:0 0 0 0 var(--ring)}
  .controls input::placeholder{color:#9aa6b2}
  .controls input:focus{border-color:var(--accent);box-shadow:0 0 0 6px var(--ring)}

  .tables{display:grid;grid-template-columns:1fr 1fr;gap:16px;padding:16px}
  @media (max-width:900px){.tables{grid-template-columns:1fr}}
  .table-wrap{border:1px solid var(--line);border-radius:14px;overflow:hidden;background:var(--surface)}
  table{width:100%;border-collapse:separate;border-spacing:0}
  th,td{border-bottom:1px solid var(--line);padding:10px 10px;vertical-align:middle}
  th{background:color-mix(in oklab,var(--surface) 90%,var(--bg));font-weight:700}
  tr:last-child th,tr:last-child td{border-bottom:0}
  .sec-title{background:var(--sec-bg)!important;color:var(--sec-fg)!important;text-align:left;font-weight:800}
  .right{text-align:right}
  .mono{font-variant-numeric:tabular-nums}
  .yellow{background:var(--yellow)}
  .num-input{width:100%;text-align:right;padding:6px 8px;border:1px solid var(--line);border-radius:8px;background:var(--surface);color:var(--text)}
  .num-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 4px var(--ring)}
  .highlight-cell{background:#fffdf7;border:2px inset #000;border-radius:12px;font-weight:700}
  .note{padding:16px;font-size:13px;color:var(--muted);border-top:1px solid var(--line);line-height:1.6}
  footer{max-width:1100px;margin:24px auto;padding:12px 16px;color:var(--muted);font-size:12px;line-height:1.6}
</style>
</head>
<body>

<!-- 상단 -->
<div class="appbar">
  <div class="brand">
    <a href="./" aria-label="LISANG Lab 홈으로">
      <span class="logo"></span>LISANG&nbsp;Lab
    </a>
  </div>
  <div style="display:flex;gap:10px;align-items:center;">
    <label for="navSelect" class="subtle" style="font-size:12px;color:var(--muted);">계산기</label>
    <select id="navSelect">
      <option value="./">메인</option>
      <option value="./severance.html">퇴직금 계산기</option>
      <option value="./annual.html" selected>연차휴가 계산기</option>
      <option value="./hours52.html">주휴시간 계산기</option>
      <option value="./parental.html">출산·육아휴직 계산기</option>
    </select>
    <button id="themeBtn" class="btn" type="button">🌙 다크 모드</button>
  </div>
</div>

<div class="container">
  <div class="sheet">
    <h1>연차휴가 계산기 (입사일 기준 · 회계연도 기준)</h1>

    <div class="controls">
      <label>입사일 <input id="joinDate" type="text" placeholder="yyyy-mm-dd"></label>
      <label>퇴사일 <input id="leaveDate" type="text" placeholder="yyyy-mm-dd"></label>
      <button id="calcBtn" class="btn">계산</button>
      <span class="subtle">날짜는 8자리(예: 20240712)만 입력해도 됩니다.</span>
    </div>

    <div class="tables">
      <div class="table-wrap">
        <table id="tblFiscal">
          <tr><th class="sec-title" colspan="5">연차휴가 계산기 (회계연도 기준)</th></tr>
          <tr>
            <th style="width:20%">구분</th>
            <th class="yellow">발생일자</th>
            <th class="yellow right">발생일수</th>
            <th class="right">기 사용일수</th>
            <th class="right">보상일수</th>
          </tr>
          <tbody id="fiscalBody"></tbody>
          <tr>
            <th>합계</th>
            <td class="yellow"></td>
            <td class="yellow right mono highlight-cell" id="fiscalSum">0</td>
            <td class="right mono highlight-cell" id="fiscalUsedSum">0</td>
            <td class="right mono highlight-cell" id="fiscalCompSum">0</td>
          </tr>
        </table>
      </div>

      <div class="table-wrap">
        <table id="tblAnniv">
          <tr><th class="sec-title" colspan="5">연차휴가 계산기 (입사일 기준)</th></tr>
          <tr>
            <th style="width:20%">근속년수</th>
            <th class="yellow">발생일자</th>
            <th class="yellow right">발생일수</th>
            <th class="right">기 사용일수</th>
            <th class="right">보상일수</th>
          </tr>
          <tbody id="annivBody"></tbody>
          <tr>
            <th>합계</th>
            <td class="yellow"></td>
            <td class="yellow right mono highlight-cell" id="annivSum">0</td>
            <td class="right mono highlight-cell" id="annivUsedSum">0</td>
            <td class="right mono highlight-cell" id="annivCompSum">0</td>
          </tr>
        </table>
      </div>
    </div>

    <div class="note">
      * 2017년 5월 29일 이전 입사자의 경우에도 자동 계산됩니다.<br>
      * 회계연도 기준보다 입사일 기준으로 보상일수가 많으면 입사일 기준으로 정산하여야 합니다.<br>
      * 상기 계산 방식은 업무의 편의를 돕기 위한 것으로 법적 효력이 없으며 구체적인 내용은 공인노무사에 문의 바랍니다.
    </div>
  </div>
</div>

<footer>
  ⓒ 2025 LISANG Lab. all rights reserved.<br>
  본 사이트의 콘텐츠(문서, 코드, 디자인, 계산 로직 등)는 비영리적 목적의 공유·인용·배포는 출처(‘LISANG Lab’)를 명시하면 자유롭게 허용합니다.<br>
  단, 동의없는 상업적 이용(영리 목적의 복제·배포·판매·재가공 등)은 금지됩니다.<br>
  본 계산기는 참고용이며, 계산 결과에 따른 법적 책임은 지지 않습니다.<br>
  이용 중 오류 제보나 개선 제안은 <a href="mailto:lisang.hr.lab@gmail.com">lisang.hr.lab@gmail.com</a> 으로 연락해 주세요.
</footer>

<script>
document.getElementById('navSelect').addEventListener('change', e=>{
  if(e.target.value) location.href = e.target.value;
});
(function(){
  const saved=localStorage.getItem('theme');
  if(saved) document.documentElement.setAttribute('data-theme', saved);
  updateThemeBtn();
})();
function updateThemeBtn(){
  const dark=document.documentElement.getAttribute('data-theme')==='dark';
  document.getElementById('themeBtn').textContent=dark?'☀️ 라이트 모드':'🌙 다크 모드';
}
document.getElementById('themeBtn').addEventListener('click',()=>{
  const cur=document.documentElement.getAttribute('data-theme')||'light';
  const next=cur==='light'?'dark':'light';
  document.documentElement.setAttribute('data-theme',next);
  localStorage.setItem('theme',next);
  updateThemeBtn();
});

function toYmd(val){const v=(val||'').replace(/\D/g,'');if(v.length!==8)return null;const y=v.slice(0,4),m=v.slice(4,6),d=v.slice(6,8);
  if(+m<1||+m>12||+d<1||+d>31)return null;return `${y}-${m}-${d}`;}
['joinDate','leaveDate'].forEach(id=>{
  const el=document.getElementById(id);
  el.addEventListener('input',()=>{const fm=toYmd(el.value);if(fm)el.value=fm;});
});
const dt=s=>new Date(s);
const fmtDate=d=>d.toISOString().slice(0,10);
function addMonths(date,n){const d=new Date(date),day=d.getDate();d.setMonth(d.getMonth()+n);if(d.getDate()<day)d.setDate(0);return d;}
function addYears(date,n){const d=new Date(date);d.setFullYear(d.getFullYear()+n);return d;}
function daysInclusive(a,b){const A=(a instanceof Date)?a:new Date(a);const B=(b instanceof Date)?b:new Date(b);return Math.max(0,Math.floor((B-A)/86400000)+1);}

function monthlyAccruals(join,leave){const first=addYears(join,1);const end=(leave && leave<first)?leave:first;const arr=[];let cur=addMonths(join,1);
  while(cur<=end){arr.push(new Date(cur));cur=addMonths(cur,1);}return arr.filter(d=>d<first && (!leave || d<=leave));}
function regularDaysByYearN(n){return Math.min(25,15+Math.floor((n-1)/2));}
function fiscalDaysByDisplayYear(y){if(y<=4)return 15;const add=Math.floor((y-3)/2);return Math.min(25,15+add);}
const showIfAfterLeave=(accrual,leave)=>(!leave||leave>=accrual);

function clearTbody(tb){while(tb.firstChild)tb.removeChild(tb.firstChild);}
function tr(cs){const r=document.createElement('tr');cs.forEach(c=>r.appendChild(c));return r;}
function th(t){const e=document.createElement('th');e.textContent=t;return e;}
function td(t,c='right mono'){const e=document.createElement('td');e.textContent=t;if(c)e.className=c;return e;}

function usedCompCells(baseDays,typeTag,isLegacy){
  const usedTd=document.createElement('td');usedTd.className='right mono';
  const inp=document.createElement('input');inp.type='number';inp.min='0';inp.step='0.1';inp.value='0';inp.className='num-input mono';
  usedTd.appendChild(inp);
  const compTd=document.createElement('td');compTd.className='right mono';
  function update(){
    let comp=0;
    if(isLegacy&&(typeTag==='fiscal-y1'||typeTag==='fiscal-y2carry'||typeTag==='anniv-under1'))comp=0;
    else{const used=parseFloat(inp.value)||0;comp=Math.max(0,baseDays-used);}
    compTd.textContent=(Math.round(comp*10)/10).toString();recalcSums();
  }
  inp.addEventListener('input',update);update();return [usedTd,compTd];
}

function recalcSums(){
  [['fiscalBody','fiscalSum','fiscalUsedSum','fiscalCompSum'],['annivBody','annivSum','annivUsedSum','annivCompSum']]
  .forEach(([tb,sum,used,comp])=>{
    const tbody=document.getElementById(tb);
    const base=[...tbody.querySelectorAll('td.yellow.right')].reduce((a,e)=>a+(parseFloat(e.textContent)||0),0);
    const usedSum=[...tbody.querySelectorAll('input.num-input')].reduce((a,e)=>a+(parseFloat(e.value)||0),0);
    const compSum=[...tbody.querySelectorAll('tr')].reduce((a,row)=>{const last=row.querySelector('td:last-child');return a+(last?(parseFloat(last.textContent)||0):0);},0);
    document.getElementById(sum).textContent=(Math.round(base*10)/10).toString();
    document.getElementById(used).textContent=(Math.round(usedSum*10)/10).toString();
    document.getElementById(comp).textContent=(Math.round(compSum*10)/10).toString();
  });
}

function calc(){
  const jStr=document.getElementById('joinDate').value;const lStr=document.getElementById('leaveDate').value;if(!jStr)return;
  const join=dt(jStr),leave=lStr?dt(lStr):null;const isLegacy=join<new Date('2017-05-29');
  const aBody=document.getElementById('annivBody');clearTbody
