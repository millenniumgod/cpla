<!doctype html>
<html lang="ko" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>í‰ê· ì„ê¸ˆ ë° í‡´ì§ê¸ˆ ê³„ì‚°ê¸°</title>
<meta name="description" content="í‰ê· ì„ê¸ˆ ë° í‡´ì§ê¸ˆ ê³„ì‚°ê¸° - 3ê°œì›”(ìµœëŒ€ 4ê°œì›” êµ¬ê°„) ì„ê¸ˆ, í‰ê· ì„ê¸ˆ, í‡´ì§ê¸ˆ ìë™ ê³„ì‚°" />
<style>
  /* ===== THEME TOKENS ===== */
  :root{
    /* light (default) */
    --bg:#f6f8fb; --surface:#ffffff; --elev:#ffffff;
    --line:#e5eaf0; --muted:#516173; --text:#0d1b2a; --title:#0a0f18;
    --accent:#2a66ff; --accent-2:#19a06a; --danger:#e24545; --ring:rgba(42,102,255,.22);

    /* section header unified color (from swatch: deep navy) */
    --sec-bg:#0a2a60;  /* í•„ìš” ì‹œ ì´ ê°’ë§Œ ë°”ê¾¸ë©´ ë©ë‹ˆë‹¤ */
    --sec-fg:#ffffff;
  }
  [data-theme="dark"]{
    --bg:#0a0e13; --surface:#0f1520; --elev:#121a26;
    --line:#1f2a3a; --muted:#8ea4b8; --text:#eef4fb; --title:#ffffff;
    --accent:#62a8ff; --accent-2:#19c37d; --danger:#ff6b6b; --ring:rgba(98,168,255,.35);

    --sec-bg:#0a2a60;  /* ë‹¤í¬ì—ì„œë„ ë™ì¼ ë„¤ì´ë¹„ë¡œ ìœ ì§€ */
    --sec-fg:#ffffff;
  }

  /* ===== BASE ===== */
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,Helvetica,Arial,sans-serif}
  a{color:var(--accent);text-decoration:none}

  /* App bar */
  .appbar{
    position:sticky;top:0;z-index:10;
    display:flex;justify-content:space-between;align-items:center;gap:12px;
    padding:12px 16px;background:var(--bg);border-bottom:1px solid var(--line);
    backdrop-filter:saturate(140%) blur(6px)
  }
  .brand{font-weight:800;letter-spacing:-.2px;color:var(--title)}
  .brand span{opacity:.65;font-weight:600}
  .bar-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  select, .btn, input[type="text"], input[type="number"]{
    background:var(--surface);color:var(--text);border:1px solid var(--line);border-radius:12px;
    padding:10px 12px;outline:none;transition:.15s ease;box-shadow:0 0 0 0 var(--ring)
  }
  select:hover, .btn:hover, input[type="text"]:hover, input[type="number"]:hover{border-color:color-mix(in oklab, var(--accent) 30%, var(--line))}
  select:focus, input[type="text"]:focus, input[type="number"]:focus{box-shadow:0 0 0 6px var(--ring);border-color:var(--accent)}
  .btn{cursor:pointer;font-weight:700}
  .btn.primary{border-color:var(--accent);background:color-mix(in oklab, var(--accent) 12%, var(--surface));}
  .btn.ghost{background:var(--surface)}
  .toggle{display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:8px 12px}
  .toggle span{font-size:12px;color:var(--muted)}

  /* Layout */
  .container{max-width:1100px;margin:28px auto 80px;padding:0 16px}
  .sheet{background:var(--elev);border:1px solid var(--line);border-radius:18px;overflow:hidden;box-shadow:0 8px 30px color-mix(in oklab, #000 20%, transparent)}
  .sheet h1{margin:0;padding:18px 18px 16px;background:color-mix(in oklab, var(--surface) 92%, var(--bg));
    text-align:center;font-size:20px;font-weight:800;color:var(--title);letter-spacing:.6px;border-bottom:1px solid var(--line)}
  .subtle{font-size:12px;color:var(--muted)}

  /* Tables (responsive) */
  .section-wrap{padding:12px 16px}
  .table-wrap{border:1px solid var(--line);border-radius:14px;overflow:hidden;overflow-x:auto;background:var(--surface)}
  table{width:100%;border-collapse:separate;border-spacing:0;min-width:840px}
  th,td{border-bottom:1px solid var(--line);padding:12px 12px;vertical-align:middle}
  th{background:color-mix(in oklab, var(--surface) 90%, var(--bg));font-weight:700}
  tr:last-child td,tr:last-child th{border-bottom:0}
  .sec-title{font-weight:800;text-align:left;background:var(--sec-bg)!important;color:var(--sec-fg)!important}
  input[type="number"]{text-align:right}
  .mono{font-variant-numeric:tabular-nums}
  .right{text-align:right}
  .kpi{display:flex;gap:18px;flex-wrap:wrap;padding:16px}
  .chip{background:var(--surface);border:1px solid var(--line);padding:12px;border-radius:12px;min-width:180px}
  .chip strong{display:block;font-size:12px;color:var(--muted);margin-bottom:4px}
  .chip .val{font-size:18px;font-weight:800}

  .row-actions{display:flex;gap:10px;align-items:center;padding:16px;border-top:1px solid var(--line);background:var(--surface)}
  .note{padding:18px;border-top:1px solid var(--line);background:var(--surface);color:var(--muted);line-height:1.7;font-size:13px;border-bottom-left-radius:18px;border-bottom-right-radius:18px}
</style>
</head>
<body>

<!-- Sticky top bar -->
<div class="appbar">
  <div class="brand">í‡´ì§ê¸ˆ ê³„ì‚°ê¸° <span>Â· í‰ê· ì„ê¸ˆ ì‚°ì •</span></div>
  <div class="bar-actions">
    <label for="calcSelect" class="subtle">ê³„ì‚°ê¸°</label>
    <select id="calcSelect">
      <option value="">â€” ì„ íƒ â€”</option>
      <option value="./severance.html" selected>í‡´ì§ê¸ˆ ê³„ì‚°ê¸°</option>
      <option value="./annual.html">ì—°ì°¨ìˆ˜ë‹¹ ê³„ì‚°ê¸°</option>
      <option value="./hours52.html">ì£¼52ì‹œê°„ ê³„ì‚°ê¸°</option>
      <option value="./">ë©”ì¸</option>
    </select>

    <button id="themeBtn" class="btn toggle" type="button" title="ë‹¤í¬ ëª¨ë“œ ì „í™˜">
      <span id="themeIcon">ğŸŒ™</span><span>ë‹¤í¬ ëª¨ë“œ</span>
    </button>
  </div>
</div>

<div class="container">
  <div class="sheet">
    <h1>í‰ê· ì„ê¸ˆ ë° í‡´ì§ê¸ˆ ê³„ì‚°ê¸°</h1>

    <!-- 1. ì¸ì ì‚¬í•­ -->
    <div class="section-wrap">
      <div class="table-wrap">
        <table>
          <tr><th class="sec-title" colspan="8">1. ì¸ì ì‚¬í•­</th></tr>
          <tr>
            <th style="width:14%">ì…ì‚¬ì—°ì›”ì¼</th>
            <td><input id="joinDate" type="text" placeholder="yyyy-mm-dd" data-next="leaveDate" /></td>
            <th style="width:14%">í‡´ì‚¬ì—°ì›”ì¼</th>
            <td><input id="leaveDate" type="text" placeholder="yyyy-mm-dd" data-next="p1s" /></td>
            <th style="width:14%"></th><td></td><th style="width:14%"></th><td></td>
          </tr>
          <tr>
            <th>ê·¼ì† ì—°ìˆ˜</th>
            <td colspan="3">
              <span class="mono" id="svcY">0</span>ë…„
              <span class="mono" id="svcM">0</span>ê°œì›”
              <span class="mono" id="svcD">0</span>ì¼
            </td>
            <th>ì´ ê·¼ë¡œì¼ìˆ˜</th>
            <td class="right mono" id="svcDays">0</td>
            <td colspan="2"></td>
          </tr>
        </table>
      </div>
    </div>

    <!-- 2. í‰ê· ì„ê¸ˆì˜ ê³„ì‚° -->
    <div class="section-wrap">
      <div class="table-wrap">
        <table>
          <tr><th class="sec-title" colspan="8">2. í‰ê· ì„ê¸ˆì˜ ê³„ì‚°</th></tr>
          <tr><td class="subtle" colspan="8">â€» í‰ê· ì„ê¸ˆ = ìµœê·¼ 3ê°œì›” ì´ì„ê¸ˆ Ã· (ìµœê·¼ 3ê°œì›” ì´ì¼ìˆ˜ âˆ’ ì œì™¸ì¼ìˆ˜). 3ê°œì›”ì´ 4ê°œì›” êµ¬ê°„ìœ¼ë¡œ ë‚˜ë‰  ìˆ˜ ìˆìŒ.</td></tr>

          <tr><th colspan="8">2-1) ìµœê·¼ 3ê°œì›” ê¸°ê°„(ìµœëŒ€ 4êµ¬ê°„)</th></tr>
          <tr>
            <th style="width:14%">êµ¬ê°„</th>
            <th>ì‹œì‘ì¼</th>
            <th>ì¢…ë£Œì¼</th>
            <th style="width:14%">ì¼ìˆ˜(ìë™)</th>
            <th colspan="2">ì„ê¸ˆ(ê¸‰ì—¬/ìˆ˜ë‹¹ ë“±)</th>
            <th colspan="2">ë¹„ê³ </th>
          </tr>
          <tr>
            <td>â‘ </td>
            <td><input id="p1s" type="text" placeholder="yyyy-mm-dd" data-next="p1e" /></td>
            <td><input id="p1e" type="text" placeholder="yyyy-mm-dd" data-next="p2s" /></td>
            <td class="right mono" id="p1d">0</td>
            <td colspan="2"><input id="p1w" type="number" value="0" /></td>
            <td colspan="2" class="subtle">ì˜ˆ: 7/10~7/31</td>
          </tr>
          <tr>
            <td>â‘¡</td>
            <td><input id="p2s" type="text" placeholder="yyyy-mm-dd" data-next="p2e" /></td>
            <td><input id="p2e" type="text" placeholder="yyyy-mm-dd" data-next="p3s" /></td>
            <td class="right mono" id="p2d">0</td>
            <td colspan="2"><input id="p2w" type="number" value="0" /></td>
            <td colspan="2" class="subtle">ì˜ˆ: 8/1~8/31</td>
          </tr>
          <tr>
            <td>â‘¢</td>
            <td><input id="p3s" type="text" placeholder="yyyy-mm-dd" data-next="p3e" /></td>
            <td><input id="p3e" type="text" placeholder="yyyy-mm-dd" data-next="p4s" /></td>
            <td class="right mono" id="p3d">0</td>
            <td colspan="2"><input id="p3w" type="number" value="0" /></td>
            <td colspan="2" class="subtle">ì˜ˆ: 9/1~9/30</td>
          </tr>
          <tr>
            <td>â‘£</td>
            <td><input id="p4s" type="text" placeholder="yyyy-mm-dd" data-next="p4e" /></td>
            <td><input id="p4e" type="text" placeholder="yyyy-mm-dd" data-next="excl" /></td>
            <td class="right mono" id="p4d">0</td>
            <td colspan="2"><input id="p4w" type="number" value="0" /></td>
            <td colspan="2" class="subtle">ì˜ˆ: 10/1~10/10</td>
          </tr>
          <tr>
            <th>ì œì™¸ì¼ìˆ˜ í•©ê³„</th>
            <td colspan="2"><input id="excl" type="number" value="0" /></td>
            <th>ì´ì¼ìˆ˜(ë‹¬ë ¥ì¼)</th>
            <td class="right mono" id="totDays">0</td>
            <th>ë¶„ëª¨(ì´ì¼ìˆ˜âˆ’ì œì™¸)</th>
            <td class="right mono" id="effDays" colspan="2">0</td>
          </tr>
          <tr>
            <th>ìµœê·¼3ê°œì›” ì„ê¸ˆ í•©ê³„</th>
            <td class="right mono" id="wageSum" colspan="2">0</td>
            <th>í‰ê· ì„ê¸ˆ(1ì¼)</th>
            <td class="right mono" id="avgDaily">0</td>
            <th>í‰ê· ì„ê¸ˆ(30ì¼ë¶„)</th>
            <td class="right mono" id="avg30" colspan="2">0</td>
          </tr>

          <tr><th colspan="8">2-2) ì—°ì°¨ìˆ˜ë‹¹Â·ìƒì—¬ê¸ˆ (ì…ë ¥ ê¸ˆì•¡ì€ ìë™ìœ¼ë¡œ 3/12 ë°˜ì˜)</th></tr>
          <tr>
            <th>ì—°ì°¨ìˆ˜ë‹¹<br>(ê¸ˆì•¡ ì…ë ¥)</th>
            <td colspan="2"><input id="ann3m" type="number" value="0" /></td>
            <th>ìƒì—¬ê¸ˆ<br>(ê¸ˆì•¡ ì…ë ¥)</th>
            <td colspan="2"><input id="bon3m" type="number" value="0" /></td>            
          </tr>
          <tr>
            <th>ì´ ì„ê¸ˆ(ê°€ì‚° í›„)</th>
            <td class="right mono" id="allSum" colspan="7">0</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- KPI glance -->
    <div class="kpi">
      <div class="chip"><strong>ê·¼ì†ì¼ìˆ˜</strong><div class="val mono" id="kpiSvc">0</div></div>
      <div class="chip"><strong>í‰ê· ì„ê¸ˆ(1ì¼)</strong><div class="val mono" id="kpiAvg">0</div></div>
      <div class="chip"><strong>í‡´ì§ê¸ˆ(ë²•ì •)</strong><div class="val mono" id="kpiSev">0</div></div>
    </div>

    <!-- 3. í‡´ì§ê¸ˆ -->
    <div class="section-wrap">
      <div class="table-wrap">
        <table>
          <tr><th class="sec-title" colspan="8">3. í‡´ì§ê¸ˆ</th></tr>
          <tr>
            <th>í‰ê· ì„ê¸ˆ(1ì¼)</th>
            <td class="right mono" id="avgDaily2">0</td>
            <th>í‡´ì§ê¸ˆ(ë²•ì •)</th>
            <td class="right mono" id="sevPay">0</td>
            <td colspan="4"></td>
          </tr>
          <tr>
            <td colspan="8" class="subtle">â€» ì•„ë˜ í‡´ì§ë³´í—˜ê¸ˆ ë° ì¤‘ê°„ì •ì‚°, ê¸°ì§€ê¸‰ê¸ˆì€ ì§€ê¸‰ì´ë ¥ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ê¸°ì…</td>
          </tr>
          <tr>
            <th>í‡´ì§ë³´í—˜ê¸ˆ</th>
            <td class="right"><input id="insPay" type="number" value="0" /></td>
            <th>ì¤‘ê°„ì •ì‚°/ê¸°ì§€ê¸‰ê¸ˆ</th>
            <td class="right"><input id="paidPay" type="number" value="0" /></td>
            <td colspan="4"></td>
          </tr>
          <tr>
            <th>ì°¨ì¸ì§€ê¸‰ì•¡</th>
            <td class="right mono" id="diffPay" colspan="7">0</td>
          </tr>
        </table>
      </div>
    </div>

    <div class="row-actions">
      <button class="btn primary" id="btnCalc">í‡´ì§ê¸ˆ ê³„ì‚°</button>      
    </div>

    <!-- ìµœì¢… ì•ˆë‚´ ë¬¸êµ¬ -->
    <div class="note" id="legalNote">
      * í‡´ì‚¬ì—°ì›”ì¼ì€ ë§ˆì§€ë§‰ ê·¼ë¬´ì¼ ë‹¤ìŒë‚ ì„ ì…ë ¥<br>
      * í‡´ì§ê¸ˆ(ë²•ì •) = í‰ê· ì„ê¸ˆ Ã— 30ì¼ Ã— (ì¬ì§ì¼ìˆ˜Ã·365). ê·¼ì† 1ë…„ ë¯¸ë§Œì€ í‡´ì§ê¸ˆ ë¯¸ë°œìƒ<br>
      * ê·¼ë¡œìí‡´ì§ê¸‰ì—¬ë³´ì¥ë²•ì— ë”°ë¥¸ í‡´ì§ê¸ˆ ê³„ì‚°ê¸°ë¡œ ë³¸ ê³„ì‚°ê²°ê³¼ëŠ” ë²•ì  ì˜ë¯¸ê°€ ì—†ìœ¼ë©°, ë²•ë¥ ì  ì±…ì„ì„ ë¶€ë‹´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </div>
  </div>
</div>

<script>
  /* ===== Theme toggle (persist) ===== */
  (function(){
    const saved = localStorage.getItem('theme');
    if(saved) document.documentElement.setAttribute('data-theme', saved);
    updateThemeBtn();
  })();

  function updateThemeBtn(){
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
    document.getElementById('themeIcon').textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
    document.getElementById('themeBtn').title = isDark ? 'ë¼ì´íŠ¸ ëª¨ë“œë¡œ' : 'ë‹¤í¬ ëª¨ë“œë¡œ';
    document.querySelector('#themeBtn span:last-child').textContent = isDark ? 'ë¼ì´íŠ¸ ëª¨ë“œ' : 'ë‹¤í¬ ëª¨ë“œ';
  }

  document.getElementById('themeBtn').addEventListener('click', ()=>{
    const cur = document.documentElement.getAttribute('data-theme') || 'light';
    const next = cur === 'light' ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
    updateThemeBtn();
  });

  /* ===== Navigation ===== */
  document.getElementById('calcSelect').addEventListener('change', e=>{
    if(e.target.value) location.href = e.target.value;
  });

  /* ===== Date UX: 20240101 -> 2024-01-01 ===== */
  function toYmd(val){
    const v = (val||'').replace(/\D/g,'');
    if(v.length !== 8) return null;
    const y=v.slice(0,4), m=v.slice(4,6), d=v.slice(6,8);
    const mm=+m, dd=+d; if(mm<1||mm>12||dd<1||dd>31) return null;
    return `${y}-${m}-${d}`;
  }
  function attachDateInput(id){
    const el = document.getElementById(id);
    el.addEventListener('input', ()=>{
      const fm = toYmd(el.value);
      if(fm){
        el.value = fm;
        const nextId = el.getAttribute('data-next');
        if(nextId){ const n = document.getElementById(nextId); if(n) n.focus(); }
        autoRecalc();
      }
    });
    el.addEventListener('change', autoRecalc);
    el.addEventListener('blur', autoRecalc);
  }

  /* ===== Date + Calc utils ===== */
  function daysInclusive(s, e){
    if(!s||!e) return 0;
    const S=new Date(s), E=new Date(e);
    return Math.max(0, Math.floor((E - S)/(1000*60*60*24)) + 1);
  }
  // ê·¼ì†: í‡´ì‚¬ì¼ ë¯¸í¬í•¨
  function serviceDaysExclusive(jd, ld){
    if(!jd||!ld) return 0;
    const S=new Date(jd), E=new Date(ld);
    return Math.max(0, Math.floor((E - S)/(1000*60*60*24)));
  }
  function humanizeDays(days){
    const y=Math.floor(days/365), r=days%365, m=Math.floor(r/30), d=r%30; return {y,m,d};
  }
  const fmt = n => Number.isFinite(n) ? n.toLocaleString('ko-KR') : '0';

  function updateTotals(){
    const trip=[['p1s','p1e','p1d'],['p2s','p2e','p2d'],['p3s','p3e','p3d'],['p4s','p4e','p4d']];
    let totDays=0;
    trip.forEach(([sId,eId,dId])=>{
      const s=document.getElementById(sId).value;
      const e=document.getElementById(eId).value;
      const d=daysInclusive(s,e);
      totDays+=d;
      document.getElementById(dId).textContent=fmt(d);
    });

    const excl=Number(document.getElementById('excl').value||0);
    const effDays=Math.max(totDays - excl, 0);

    const wages=['p1w','p2w','p3w','p4w'].map(id=>Number(document.getElementById(id).value||0));
    const wageSum=wages.reduce((a,b)=>a+b,0);

    /* (2) ì—°ì°¨/ìƒì—¬: ì…ë ¥ê°’ì„ 3/12ë¡œ ìë™ ë°˜ì˜ */
    const annInput=Number(document.getElementById('ann3m').value||0);
    const bonInput=Number(document.getElementById('bon3m').value||0);
    const annAdj=annInput*(3/12);
    const bonAdj=bonInput*(3/12);

    const allSum=wageSum + annAdj + bonAdj;

    const avgDaily = effDays>0 ? (allSum/effDays) : 0;
    const avg30 = avgDaily*30;

    document.getElementById('totDays').textContent=fmt(totDays);
    document.getElementById('effDays').textContent=fmt(effDays);
    document.getElementById('wageSum').textContent=fmt(wageSum);
    document.getElementById('allSum').textContent=fmt(allSum);
    document.getElementById('avgDaily').textContent=fmt(Math.round(avgDaily));
    document.getElementById('avg30').textContent=fmt(Math.round(avg30));
    document.getElementById('avgDaily2').textContent=fmt(Math.round(avgDaily));

    document.getElementById('kpiAvg').textContent=fmt(Math.round(avgDaily));
  }

  function updateService(){
    const jd=document.getElementById('joinDate').value;
    const ld=document.getElementById('leaveDate').value;
    const svc=serviceDaysExclusive(jd, ld);
    const h=humanizeDays(svc);
    document.getElementById('svcDays').textContent=fmt(svc);
    document.getElementById('svcY').textContent=h.y; document.getElementById('svcM').textContent=h.m; document.getElementById('svcD').textContent=h.d;
    document.getElementById('kpiSvc').textContent=fmt(svc);
  }

  function autoRecalc(){ updateService(); updateTotals(); }

  // ì…ë ¥ ë°”ì¸ë”©
  ['p1s','p1e','p2s','p2e','p3s','p3e','p4s','p4e','p1w','p2w','p3w','p4w','excl','ann3m','bon3m']
    .forEach(id=>{
      const el=document.getElementById(id);
      el.addEventListener('input', autoRecalc);
      el.addEventListener('change', autoRecalc);
      el.addEventListener('blur', autoRecalc);
    });
  ['joinDate','leaveDate','p1s','p1e','p2s','p2e','p3s','p3e','p4s','p4e'].forEach(attachDateInput);

  // í‡´ì§ê¸ˆ ê³„ì‚° ë²„íŠ¼
  document.getElementById('btnCalc').addEventListener('click', ()=>{
    autoRecalc();
    const svc = Number((document.getElementById('svcDays').textContent||'0').replace(/,/g,''))||0;
    const eligible = svc >= 365;
    const avgDaily = Number((document.getElementById('avgDaily2').textContent||'0').replace(/,/g,''))||0;
    const sev = eligible ? Math.floor(avgDaily * 30 * (svc/365)) : 0;
    document.getElementById('sevPay').textContent=fmt(sev);
    document.getElementById('kpiSev').textContent=fmt(sev);

    const ins=Number(document.getElementById('insPay').value||0);
    const paid=Number(document.getElementById('paidPay').value||0);
    const diff=Math.max(sev - (ins + paid), 0);
    document.getElementById('diffPay').textContent=fmt(diff);
  });
</script>
</body>
</html>
